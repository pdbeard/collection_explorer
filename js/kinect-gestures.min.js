window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){a.stream===Kinect.SKELETON_STREAM_NAME&&(KinectGestures.options.debug&&KinectGestures.DebugDrawer.update(a),KinectGestures.options.registerPlayer&&(KinectGestures.PlayerRegister.started===!1&&(KinectGestures.PlayerRegister.init(),KinectGestures.PlayerRegister.started=!0),KinectGestures.PlayerRegister.update(a)),KinectGestures.GestureManager.update(a))}function b(a){KinectGestures.MapTypeClass[a]&&KinectGestures.GestureManager.registerGesture(KinectGestures[KinectGestures.MapTypeClass[a]])}function c(a){KinectGestures.MapTypeClass[a]&&KinectGestures.GestureManager.unregisterGesture(KinectGestures.MapTypeClass[a])}if(!Kinect)throw"Kinect 1.8.0 SDK required";var d=null;KinectGestures.options={debug:!1,registerPlayer:!0,numPlayersToRegister:1,checkStability:!0,canvasElementID:!1,log:!1,logElementID:null},KinectGestures.GestureType={Wave:"wave",Jump:"jump",JumpPosition:"jumpPosition",JumpPositionHip:"jumpPositionHip",Squat:"squat",SquatPosition:"squatPosition",Swipe:"swipe",PlayerPosition:"playerPosition",Joystick:"joystick"},KinectGestures.EventType={PlayerEngagedAgain:"playerEngagedAgain",PlayerLost:"playerLost",PlayersTracked:"playersTracked",PlayerTracked:"playerTracked",PlayerRegister:"playerRegister"},KinectGestures.MapTypeClass={wave:"WaveGesture",jump:"JumpGesture",jumpPosition:"JumpCalibratedGesture",jumpPositionHip:"JumpCalibratedHipGesture",squat:"SquatGesture",squatPosition:"SquatCalibrated",swipe:"SwipeGesture",playerPosition:"PlayerPosition",joystick:"JoystickGesture"},KinectGestures.init=function(a,b){if(!a)throw"You need to set a sensor";if(d=a,b)for(var c in KinectGestures.options)"undefined"!=typeof b[c]&&(KinectGestures.options[c]=b[c]);KinectGestures.options.canvasElementID&&(KinectGestures.DebugDrawer.CanvasElemntID=KinectGestures.options.canvasElementID),KinectGestures.enable()},KinectGestures.enable=function(){d&&(d.addStreamFrameHandler(a),d.connect())},KinectGestures.disable=function(){d&&(d.removeStreamFrameHandler(a),d.disconnect())},KinectGestures.toggleDebugMode=function(){KinectGestures.options.debug=!KinectGestures.options.debug},KinectGestures.emitter=document.createElement("div"),KinectGestures.emit=function(a,b){var c=document.createEvent("Event");c.initEvent(a,!0,!0),c.data=b,KinectGestures.emitter.dispatchEvent(c)},KinectGestures.addEventListener=function(a,c){b(a),KinectGestures.emitter.addEventListener(a,c)},KinectGestures.removeEventListener=function(a,b){c(a),KinectGestures.emitter.removeEventListener(a,b)},KinectGestures.on=KinectGestures.addEventListener,KinectGestures.off=KinectGestures.removeEventListener;var e=null;KinectGestures.log=function(a){!e&&KinectGestures.options.logElementID&&KinectGestures.options.log&&(e=document.getElementById(KinectGestures.options.logElementID)),e&&(e.innerHTML=a)},KinectGestures.Utils={},KinectGestures.Utils.Inherits=function(a,b){a.prototype=Object.create(b.prototype)}}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){this.person=a,this.gestureName="",this.timeout=0,this.conditions=[];var b=0,c=0,d=0;this.Check=function(a){var e=this.conditions[b].Check(a);if(e)switch(e.res){case 0:this.Reset();break;case 1:if(b===this.conditions.length-1){d++,KinectGestures.log(this.gestureName+": "+JSON.stringify(e.args)+" - ti:"+d);var f=e.args?e.args:{};f.trackingId=a.trackingId,KinectGestures.emit(this.gestureName,f),this.Reset()}else c=Date.now(),b++;case-1:}this.timeout>0&&c<=Date.now()-this.timeout&&this.Reset()},this.Reset=function(){b=0,c=Date.now()}}KinectGestures.GestureChecker=a}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},window.JointType=window.KinectGestures.JointType={HandRight:11,WristRight:10,ElbowRight:9,ShoulderRight:8,ShoulderCenter:2,ShoulderLeft:4,ElbowLeft:5,WristLeft:6,HandLeft:7,Head:3,Spine:1,HipCenter:0,FootRight:19,AnkleRight:18,KneeRight:17,HipRight:16,HipLeft:12,KneeLeft:13,AnkleLeft:14,FootLeft:15},function(){function a(){}var b=[],c=50,d=0,e=[];a.registeredGestures=[],a.gesturesInProgress={},a.registerGesture=function(b){a.registeredGestures.indexOf(b)>=0||(a.registeredGestures.push(b),KinectGestures.PersonManager.updateGestures())},a.unregisterGesture=function(b){-1!==a.registeredGestures.indexOf(b)&&(b.destroy&&b.destroy(),a.registeredGestures.splice(a.registeredGestures.indexOf(b),1),KinectGestures.PersonManager.updateGestures())},a.update=function(e){b=[];for(var f=e.skeletons.length-1;f>=0;f--)e.skeletons[f].trackingState>0&&b.push(e.skeletons[f]);if(a.checkSkeletonTracking(b),b.length>0){d>=c?(KinectGestures.PlayerRegister.checkSkeletonTracking(b),KinectGestures.PersonManager.checkSkeletonTracking(b),d=0):d++;for(var g=b.length-1;g>=0;g--)KinectGestures.PersonManager.update(b[g])}},a.checkSkeletonTracking=function(a){if(a.length<e.length){if(0===a.length)for(var b=e.length-1;b>=0;b--){var c=KinectGestures.PlayerRegister.getPlayerById(e[b].trackingId);KinectGestures.emit(KinectGestures.EventType.PlayerLost,{trackingId:e[b].trackingId,playerNum:c?c.playerNum:-1,relativePosition:e[b].position.x<=0?1:2})}else{for(var d=[],b=e.length-1;b>=0;b--){for(var f=!1,g=a.length-1;g>=0;g--)if(a[g].trackingId===e[b].trackingId){f=!0;break}f||d.push(e[b])}for(b=d.length-1;b>=0;b--){var c=KinectGestures.PlayerRegister.getPlayerById(d[b].trackingId);KinectGestures.emit(KinectGestures.EventType.PlayerLost,{trackingId:d[b].trackingId,playerNum:c?c.playerNum:-1,relativePosition:d[b].position.x<=0?1:2})}}}e=a},KinectGestures.GestureManager=a}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(){}function b(a){var b=this;b.trackingId=a,b.frames=[],b.checker=null,b.gestures=[]}a.persons={},a.update=function(c){var d;a.persons[c.trackingId]?d=a.persons[c.trackingId]:(d=new b(c.trackingId),a.persons[c.trackingId]=d,d.Init()),d.CheckGestures(c)},a.getPerson=function(b){return a.persons[b]?a.persons[b]:null},a.updateGestures=function(){for(var b in a.persons)a.persons[b].updateGestures()},a.checkSkeletonTracking=function(b){for(var c in a.persons){for(var d=!1,e=b.length-1;e>=0;e--)if(b[e].trackingId===a.persons[c].trackingId){d=!0;break}d||(a.persons[c]=null,delete a.persons[c])}},KinectGestures.PersonManager=a;var c=8;b.prototype.UpdateGestures=function(){this.gestures=[];for(var a=KinectGestures.GestureManager.registeredGestures.length-1;a>=0;a--)this.gestures.push(new KinectGestures.GestureManager.registeredGestures[a](this))},b.prototype.Init=function(){this.checker=new KinectGestures.Checker(this),this.UpdateGestures()},b.prototype.GetLastSkeleton=function(a){return a>this.frames.length-1||0>a?null:this.frames[this.frames.length-a-1]?this.frames[this.frames.length-a-1].Skeleton:null},b.prototype.CheckGestures=function(a){this.frames.push({Skeleton:a,Timestamp:Date.now()}),this.frames.length===c&&this.frames.shift();for(var b=this.gestures.length-1;b>=0;b--)this.gestures[b].Check(a)},b.prototype.GetLastFrame=function(a){return a>this.frames.length-1||0>a?null:this.frames[this.frames.length-a-1]?this.frames[this.frames.length-a-1]:null},b.prototype.CurrentSkeleton=function(){return this.frames[this.frames.length-1].Skeleton},b.prototype.MillisBetweenFrames=function(a,b){var c=this.GetLastFrame(b).Timestamp-this.GetLastFrame(a).Timestamp;return c},KinectGestures.Person=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){this.person=a}a.prototype.GetAbsoluteVelocity=function(a){return this.HasSkeleton(1)?this.HasSkeleton(3)?KinectGestures.SkeletonMath.Median(this.SimpleAbsoluteVelocity(a,0,1),this.SimpleAbsoluteVelocity(a,1,2),this.SimpleAbsoluteVelocity(a,2,3)):this.SimpleAbsoluteVelocity(a,0,1):0},a.prototype.SimpleAbsoluteVelocity=function(a,b,c){if(!this.HasSkeleton(b)||!this.HasSkeleton(c))throw"No Skeleton at this Index";return 1e3*KinectGestures.SkeletonMath.DistanceBetweenPoints(this.person.GetLastSkeleton(b).joints[a].position,this.person.GetLastSkeleton(c).joints[a].position)/this.person.MillisBetweenFrames(c,b)},a.prototype.GetRelativeVelocity=function(a,b){if(!this.HasSkeleton(1))return 0;var c=this.SubstractedPointsAt(a,b,0),d=this.SubstractedPointsAt(a,b,1);if(!this.HasSkeleton(3))return 1e3*KinectGestures.SkeletonMath.DistanceBetweenPoints(c,d)/this.person.MillisBetweenFrames(1,0);var e=this.SubstractedPointsAt(a,b,2),f=this.SubstractedPointsAt(a,b,3);return KinectGestures.SkeletonMath.Median(1e3*KinectGestures.SkeletonMath.DistanceBetweenPoints(c,d)/this.person.MillisBetweenFrames(1,0),1e3*KinectGestures.SkeletonMath.DistanceBetweenPoints(d,e)/this.person.MillisBetweenFrames(2,1),1e3*KinectGestures.SkeletonMath.DistanceBetweenPoints(e,f)/this.person.MillisBetweenFrames(3,2))},a.prototype.HasSkeleton=function(a){return null!=this.person.GetLastSkeleton(a)},a.prototype.SubstractedPointsAt=function(a,b,c){if(!this.HasSkeleton(c))throw"No Skeleton at this Index";return KinectGestures.SkeletonMath.SubstractPoints(this.person.GetLastSkeleton(c).joints[b].position,this.person.GetLastSkeleton(c).joints[a].position)},a.prototype.GetDistanceMedian=function(a,b){return this.HasSkeleton(2)?KinectGestures.SkeletonMath.Median(GetDistance(a,b),GetDistance(a,b,1),GetDistance(a,b,2)):this.GetDistance(a,b)},a.prototype.GetDistance=function(a,b){return this.GetDistanceAtTime(a,b,0)},a.prototype.GetDistanceAtTime=function(a,b,c){if(!this.HasSkeleton(c))throw"No Skeleton at this Index";return KinectGestures.SkeletonMath.DistanceBetweenPoints(this.person.GetLastSkeleton(c).joints[a].position,this.person.GetLastSkeleton(c).joints[b].position)},a.prototype.GetAbsoluteMovement=function(a){if(!this.HasSkeleton(1)){var b={};return b[KinectGestures.SkeletonMath.Direction.None]=!0,b}return KinectGestures.SkeletonMath.DirectionTo(this.person.GetLastSkeleton(1).joints[a].position,this.person.CurrentSkeleton().joints[a].position)},a.prototype.GetRelativeMovement=function(a,b){if(!this.HasSkeleton(1)){var c={};return c[KinectGestures.SkeletonMath.Direction.None]=!0,c}return KinectGestures.SkeletonMath.DirectionTo(KinectGestures.SkeletonMath.SubstractPoints(this.person.GetLastSkeleton(1).joints[b].position,this.person.GetLastSkeleton(1).joints[a].position),KinectGestures.SkeletonMath.SubstractPoints(this.person.CurrentSkeleton().joints[b].position,this.person.CurrentSkeleton().joints[a].position))},a.prototype.GetRelativePosition=function(a,b){return KinectGestures.SkeletonMath.DirectionTo(this.person.CurrentSkeleton().joints[a].position,this.person.CurrentSkeleton().joints[b].position)},a.prototype.GetSteadyAbsoluteMovement=function(a,b){var c=[],d=[];if(1>b)throw"Duration must be at least 1";for(var e=0;b>e&&this.HasSkeleton(e+1);e++)d.push(this.person.GetLastSkeleton(e).joints[a].position),c.push(this.person.GetLastSkeleton(e+1).joints[a].position);return KinectGestures.SkeletonMath.SteadyDirectionTo(c,d)},a.prototype.GetSteadyRelativeMovement=function(a,b,c){var d=[],e=[];if(1>c)throw"Duration must be at least 1";for(var f=0;c>f&&this.HasSkeleton(f+1);f++)e.push(KinectGestures.SkeletonMath.SubstractPoints(this.person.GetLastSkeleton(f).joints[b].position,this.person.GetLastSkeleton(f).joints[a].position)),d.push(KinectGestures.SkeletonMath.SubstractPoints(this.person.GetLastSkeleton(f+1).joints[b].position,this.person.GetLastSkeleton(f+1).joints[a].position));return KinectGestures.SkeletonMath.SteadyDirectionTo(d,e)},a.prototype.GetSteadyPosition=function(a,b,c){var d=[],e=[];if(0>c)throw"Duration must be at least 1";for(var f=0;c>=f&&this.HasSkeleton(f);f++)e.push(this.person.GetLastSkeleton(f).joints[b].position),d.push(this.person.GetLastSkeleton(f).joints[a].position);return KinectGestures.SkeletonMath.SteadyDirectionTo(d,e)},KinectGestures.Checker=a}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(){}a.initPositionPlayer1=null,a.initPositionPlayer2=null,a.isRegistering=!1,a.isCalibrating=!1,a.started=!1,a.player1Engaged=!1,a.player1Detected=!1,a.player2Engaged=!1,a.player2Detected=!1,a.registeredPositions={},a.init=function(){a.isRegistering=!0,a.player1Detected=!1,a.player2Detected=!1,KinectGestures.on(KinectGestures.EventType.PlayerLost,a.onPlayerLost)},a.onPlayerLost=function(b){1===b.relativePosition?a.player1Detected=!1:a.player2Detected=!1},a.getPlayerById=function(b){return a.initPositionPlayer1&&a.initPositionPlayer1.trackingId===b?a.initPositionPlayer1:a.initPositionPlayer2&&a.initPositionPlayer2.trackingId===b?a.initPositionPlayer2:null},a.getRefSkeletonById=function(b){var c=a.getPlayerById(b);return c?c.skeleton:null},a.registerPlayerPosition=function(b){b.position.x<=0?(a.initPositionPlayer1=b.position,a.initPositionPlayer1.trackingId=b.trackingId,a.initPositionPlayer1.skeleton=b,a.initPositionPlayer1.playerNum=1,a.player1Engaged=!0,KinectGestures.emit(KinectGestures.EventType.PlayerRegister,{playerNum:1,trackingId:b.trackingId})):(a.initPositionPlayer2=b.position,a.initPositionPlayer2.trackingId=b.trackingId,a.initPositionPlayer2.skeleton=b,a.initPositionPlayer2.playerNum=2,a.player2Engaged=!0,KinectGestures.emit(KinectGestures.EventType.PlayerRegister,{playerNum:2,trackingId:b.trackingId})),(1===KinectGestures.options.numPlayersToRegister||a.player1Engaged&&a.player2Engaged)&&(a.isRegistering=!1,a.isCalibrating=!1)},a.reset=function(){a.started=!1,a.player1Engaged=!1,a.player2Engaged=!1,a.registeredPositions={}},a.update=function(b){if(a.isRegistering){for(var c=0,d=0;d<b.skeletons.length;++d){var e=b.skeletons[d];if(e.trackingState>1&&(c++,a.isRegistering)){var f=e.position.x<=0?1:2;1!==f||a.player1Detected||(a.player1Detected=!0,KinectGestures.emit(KinectGestures.EventType.PlayerTracked,{relativePosition:f,skeleton:e})),2!==f||a.player2Detected||(a.player2Detected=!0,KinectGestures.emit(KinectGestures.EventType.PlayerTracked,{relativePosition:f,skeleton:e}))}}c!==KinectGestures.options.numPlayersToRegister||a.isCalibrating||(a.isCalibrating=!0,KinectGestures.emit(KinectGestures.EventType.PlayersTracked))}},a.checkSkeletonTracking=function(b){for(var c,d=0,e=b.length-1;e>=0;e--){var f=b[e];a.initPositionPlayer1&&f.trackingId===a.initPositionPlayer1.trackingId&&(d=d>1?3:1,c=e),a.initPositionPlayer2&&f.trackingId===a.initPositionPlayer2.trackingId&&(d=d>1?3:2,c=e)}3>d&&(1===d&&b.length>1?a.initPositionPlayer2&&(a.initPositionPlayer2.trackingId=b[0===c?1:0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer2.trackingId,playerNum:2,relativePosition:2})):2===d&&b.length>1?a.initPositionPlayer1&&(a.initPositionPlayer1.trackingId=b[0===c?1:0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer1.trackingId,playerNum:1,relativePosition:1})):0===d&&b.length>0&&(1===b.length?b[0].position.x<=0?a.initPositionPlayer1&&(a.initPositionPlayer1.trackingId=b[0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer1.trackingId,playerNum:1,relativePosition:1})):a.initPositionPlayer2&&(a.initPositionPlayer2.trackingId=b[0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer2.trackingId,playerNum:2,relativePosition:2})):b[0].position.x<b[1].position.x?(a.initPositionPlayer1&&(a.initPositionPlayer1.trackingId=b[0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer1.trackingId,playerNum:1,relativePosition:1})),a.initPositionPlayer2&&(a.initPositionPlayer2.trackingId=b[1].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer2.trackingId,playerNum:2,relativePosition:2}))):(a.initPositionPlayer1&&(a.initPositionPlayer1.trackingId=b[1].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer1.trackingId,playerNum:1,relativePosition:1})),a.initPositionPlayer2&&(a.initPositionPlayer2.trackingId=b[0].trackingId,KinectGestures.emit(KinectGestures.EventType.PlayerEngagedAgain,{trackingId:a.initPositionPlayer2.trackingId,playerNum:2,relativePosition:2})))))},KinectGestures.PlayerRegister=a}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(){}var b={Forward:1,Backward:2,Upward:3,Downward:4,Left:5,Right:6,None:0},c=.06,d=.01,e=.66666666;a.DistanceBetweenPoints=function(a,b){var c=Math.abs(b.x-a.x),d=Math.abs(b.y-a.y),e=Math.abs(b.z-a.z);return Math.sqrt(c*c+d*d+e*e)},a.SubstractPoints=function(a,b){var c={};return c.x=a.x-b.x,c.y=a.y-b.y,c.z=a.z-b.z,c},a.AddPoints=function(a,b){var c={};return c.x=a.x+b.x,c.y=a.y+b.y,c.z=a.z+b.z,c},a.Median=function(){return 3===arguments.length?a.Median3(arguments[0],arguments[1],arguments[2]):a.MedianValues(arguments)},a.Median3=function(a,b,c){return a>b&&c>a||b>a&&a>c?a:b>a&&c>b||a>b&&b>c?b:c},a.MedianValues=function(a){return a.sort(),a[a.length/2]},a.SteadyDirectionTo=function(a,c){var f=[];if(a.length!=c.length)throw"Length not identical";for(var g=0;g<a.length;g++){f.push({});var h=c[g].x-a[g].x,i=c[g].y-a[g].y,j=c[g].z-a[g].z;h>d?f[g][b.Right]=!0:-d>h&&(f[g][b.Left]=!0),i>d?f[g][b.Upward]=!0:-d>i&&(f[g][b.Downward]=!0),j>d?f[g][b.Backward]=!0:-d>j&&(f[g][b.Forward]=!0)}var k={};for(var l in b){for(var m=0,g=f.length-1;g>=0;g--)f[g][b[l]]&&m++;m>a.length*e&&(k[b[l]]=!0)}return 0===Object.keys(k).length&&(k[b.None]=!0),k},a.DirectionTo=function(a,d){var e={},f=d.x-a.x,g=d.y-a.y,h=d.z-a.z;return f>c?e[b.Right]=!0:-c>f&&(e[b.Left]=!0),g>c?e[b.Upward]=!0:-c>g&&(e[b.Downward]=!0),h>c?e[b.Backward]=!0:-c>h&&(e[b.Forward]=!0),0===Object.keys(e).length&&(e[b.None]=!0),e},KinectGestures.SkeletonMath=a,KinectGestures.Direction=b,KinectGestures.SkeletonMath.Direction=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(){}function b(a,b,c,d){for(var e=[JointType.HipCenter,JointType.HipLeft,JointType.HipRight,JointType.KneeRight,JointType.KneeLeft,JointType.FootRight,JointType.FootLeft],f=e.length-1;f>=0;f--)if(b.joints[e[f]].trackingState<2)return!1;if(!c)return!0;var g=a.GetRelativePosition(JointType.HipCenter,JointType.HipLeft);if(!g[KinectGestures.Direction.Left])return!1;var h=a.GetRelativePosition(JointType.HipCenter,JointType.HipRight);if(!h[KinectGestures.Direction.Right])return!1;if(!d)return!0;if("standup"===d){var i=a.GetRelativePosition(JointType.HipLeft,JointType.KneeLeft);if(!i[KinectGestures.Direction.Downward])return!1;var j=a.GetRelativePosition(JointType.KneeLeft,JointType.FootLeft);if(!j[KinectGestures.Direction.Downward])return!1}return!0}function c(a,b,c){for(var d=[JointType.ShoulderLeft,JointType.ShoulderRight,JointType.ShoulderCenter,JointType.ElbowLeft,JointType.ElbowRight],e=d.length-1;e>=0;e--)if(b.joints[d[e]].trackingState<2)return!1;if(!c)return!0;var f=a.GetRelativePosition(JointType.ShoulderCenter,JointType.ShoulderLeft);if(!f[KinectGestures.Direction.Left])return!1;var g=a.GetRelativePosition(JointType.ShoulderCenter,JointType.ShoulderRight);if(!g[KinectGestures.Direction.Right])return!1;var h=a.GetRelativePosition(JointType.HipCenter,JointType.ShoulderCenter);return h[KinectGestures.Direction.Upward]?!0:!1}a.isWellFormed=function(a,d,e,f,g){var h=!0,i=!0;return e?"upper"===e?h=c(a,d,f):i=b(a,d,f,g):(h=c(a,d,f),i=b(a,d,f,g)),h&&i},KinectGestures.SkeletonStability=a}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){var c=a,d=c.checker,e=0,f=-1;this.Check=function(c){if(!KinectGestures.SkeletonStability.isWellFormed(d,c,"lower"))return{res:0};if(!KinectGestures.PlayerRegister.isRegistering){var g,h=KinectGestures.PlayerRegister.getPlayerById(a.trackingId);if(null!==h&&(e=c.position.x-h.x,g=Math.abs(e)>b.Options.Threshold?0>e?-1:1:0,g!==f)){f=g,b["player"+h.playerNum]=f;var i={position:f,playerNum:h.playerNum};return{res:1,args:i}}}}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.PlayerPosition,this.person=b,this.timeout=0,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={Threshold:.2},KinectGestures.PlayerPosition=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){var c=a,d=0,e=c.checker,f=0,g=600;this.Check=function(a){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(e,a,"lower",!0,"standup"))return{res:0};var c=e.GetSteadyAbsoluteMovement(JointType.AnkleRight,3),h=e.GetSteadyAbsoluteMovement(JointType.AnkleLeft,3),i=e.GetSteadyAbsoluteMovement(JointType.AnkleRight,5),j=e.GetSteadyAbsoluteMovement(JointType.AnkleLeft,5);if(0!==d||!(i[KinectGestures.Direction.Left]||i[KinectGestures.Direction.Right]||j[KinectGestures.Direction.Left]||j[KinectGestures.Direction.Right])){if(0===d&&c[KinectGestures.Direction.Upward]===!0&&h[KinectGestures.Direction.Upward])d=1,this.SetConcurrencies(),g=700,f=Date.now();else{if(d>=1&&d<b.Options.WindowSize&&c[KinectGestures.Direction.Downward]===!0&&h[KinectGestures.Direction.Downward]===!0)return this.Reset(!0),g=400,{res:1,args:""};d>=b.Options.WindowSize?this.Reset(!0):d>=1&&d++}f>0&&Date.now()-f>g&&this.ResetConcurrencies()}},this.Reset=function(){d=0,_fired=!1},this.SetConcurrencies=function(){KinectGestures.GestureManager.gesturesInProgress[a.trackingId]||(KinectGestures.GestureManager.gesturesInProgress[a.trackingId]={}),KinectGestures.GestureManager.gesturesInProgress[a.trackingId].jump=!0},this.ResetConcurrencies=function(){f=0,KinectGestures.GestureManager.gesturesInProgress&&KinectGestures.GestureManager.gesturesInProgress[a.trackingId]&&KinectGestures.GestureManager.gesturesInProgress[a.trackingId].jump&&(KinectGestures.GestureManager.gesturesInProgress[a.trackingId].jump=null,delete KinectGestures.GestureManager.gesturesInProgress[a.trackingId].jump)}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.Jump,this.person=b,this.timeout=0,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={WindowSize:15},KinectGestures.JumpGesture=b}(),function(){function a(a){function c(a){return Math.min(a.joints[JointType.FootLeft].position.y,a.joints[JointType.FootRight].position.y)/1}var d=a,e=0,f=d.checker;this.Check=function(a){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(f,a,"lower",!0,"standup"))return{res:0};var d=f.GetSteadyAbsoluteMovement(JointType.HipCenter,5);if(0!==e||!d[KinectGestures.Direction.Left]&&!d[KinectGestures.Direction.Right]){var g=KinectGestures.PlayerRegister.getRefSkeletonById(a.trackingId);if(g){var h=c(g),i=c(a),j=h-i;if(0===e&&-j>=b.Options.Threshold)e=1;else if(1===e&&-j<b.Options.Threshold){e=2;var k={res:1,args:{}};return k}e>=2&&(e++,e>=b.Options.WindowSize&&(e=0))}}}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.JumpPosition,this.person=b,this.timeout=0,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={Threshold:.05,WindowSize:4},KinectGestures.JumpCalibratedGesture=b}(),function(){function a(a){var c=a,d=0,e=c.checker;this.Check=function(a){var c=e.GetSteadyAbsoluteMovement(JointType.HipCenter,5);if(0!==d||!c[KinectGestures.Direction.Left]&&!c[KinectGestures.Direction.Right]){var f=KinectGestures.PlayerRegister.getRefSkeletonById(a.trackingId);if(f){var g=f.joints[JointType.HipCenter].position.y,h=a.joints[JointType.HipCenter].position.y,i=g-h;if(0===d&&-i>=b.Options.Threshold){d=1;var j={res:1,args:{}};return j}1===d&&-i<b.Options.Threshold&&(d=2),d>=2&&(d++,d>=b.Options.WindowSize&&(d=0))}}}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.JumpPositionHip,this.person=b,this.timeout=0,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={Threshold:.1,WindowSize:3},KinectGestures.JumpCalibratedHipGesture=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a,b){var c=a,d=(JointType.HandRight,0),e=c.checker;this.Check=function(a){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(e,a,"upper")&&0===d)return{res:0};if(a.joints[JointType.HandRight].position.y<a.joints[JointType.ElbowRight].position.y)return d=0,{res:0};if(0===d&&a.joints[JointType.HandRight].position.x>a.joints[JointType.ElbowRight].position.x&&(d=1),1===d&&a.joints[JointType.HandRight].position.x<a.joints[JointType.ElbowRight].position.x){d=0;var b={skeleton:a};return{res:1,args:b}}},this.Reset=function(){d=0,_direction=KinectGestures.SkeletonMath.Direction.None}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.Wave,this.person=b,this.timeout=800,this.conditions=[new a(b,0),new a(b,1)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),KinectGestures.WaveGesture=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a){var b=a,c=0,d=b.checker;this.Check=function(b){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(d,b,"lower",!0,"standup")&&0===c)return{res:0};var e=d.GetAbsoluteVelocity(JointType.HipCenter);if(KinectGestures.GestureManager.gesturesInProgress&&KinectGestures.GestureManager.gesturesInProgress[a.trackingId]&&KinectGestures.GestureManager.gesturesInProgress[a.trackingId].jump===!0)return void this.Reset();if(0===c&&1.2>e)return void this.Reset();var f=d.GetSteadyAbsoluteMovement(JointType.HipCenter,3);if(0===c&&(f[KinectGestures.Direction.Left]||f[KinectGestures.Direction.Right]))return void this.Reset();var g=d.GetSteadyAbsoluteMovement(JointType.FootRight,3),h=d.GetSteadyAbsoluteMovement(JointType.FootLeft,3);return g[KinectGestures.Direction.Upward]||g[KinectGestures.Direction.Upward]||h[KinectGestures.Direction.Upward]||h[KinectGestures.Direction.Upward]?void this.Reset():0===c&&f[KinectGestures.Direction.Downward]?(c=1,{res:1,args:""}):void(1===c&&f[KinectGestures.Direction.Upward]&&this.Reset())},this.Reset=function(){c=0}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.Squat,this.person=b,this.timeout=700,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),KinectGestures.SquatGesture=b}(),function(){function a(a){var c=a,d=c.checker,e="";this.Check=function(a){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(d,a,"lower"))return{res:0};var c=d.GetSteadyAbsoluteMovement(JointType.HipCenter,5);if(!c[KinectGestures.Direction.Left]&&!c[KinectGestures.Direction.Right]){var f=KinectGestures.PlayerRegister.getRefSkeletonById(a.trackingId);if(f){var g=f.joints[JointType.HipCenter].position.y-a.joints[JointType.HipCenter].position.y,h=g>=b.Options.Threshold?"down":"up";if(e!=h){var i={res:1,args:{newPosition:h,oldPosition:e}};return e=h,i}}}}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.SquatPosition,this.person=b,this.timeout=0,this.conditions=[new a(b)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={Threshold:.2},KinectGestures.SquatCalibrated=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a,b){var c=a,d=null,e=null,f=KinectGestures.SkeletonMath.Direction.None,g=0,h=c.checker,i=2,j=1.8;d=b&&b.Hand?b.Hand:JointType.HandRight;var k=b&&b.AllowedDirections?b.AllowedDirections:[KinectGestures.Direction.Left,KinectGestures.Direction.Right];if(e={},"object"==typeof k&&k.length>0)for(var l=k.length-1;l>=0;l--)e[k[l]]=!0;else e[k]=!0;this.Check=function(a){if(KinectGestures.options.checkStability&&!KinectGestures.SkeletonStability.isWellFormed(h,a,"upper")&&0===g)return{res:0};var b=h.GetRelativePosition(JointType.HipCenter,d),c=h.GetRelativePosition(JointType.ShoulderCenter,d),k=h.GetAbsoluteMovement(d),l=h.GetRelativeVelocity(JointType.HipCenter,d);if(j>l)return this.Reset(),{res:0};if(b[KinectGestures.Direction.Forward]===!0&&c[KinectGestures.Direction.Downward]===!0){if(f!=KinectGestures.Direction.None){if(!k[f]&&1>l)return this.Reset(),{res:0};if(g>=i){var m={res:1,args:{direction:f,hand:d}};return this.Reset(),m}return g++,{res:-1}}if(k[KinectGestures.Direction.Left]===!0&&e[KinectGestures.Direction.Left]===!0)f=KinectGestures.Direction.Left;else{if(k[KinectGestures.Direction.Right]!==!0||e[KinectGestures.Direction.Right]!==!0)return this.Reset(),{res:0};f=KinectGestures.Direction.Right}}},this.Reset=function(){g=0,f=KinectGestures.SkeletonMath.Direction.None}}function b(c){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.Swipe,this.person=c,this.timeout=1500,this.conditions=[new a(c,b.Options)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),b.Options={Hand:JointType.HandRight,AllowedDirections:[KinectGestures.Direction.Left,KinectGestures.Direction.Right]},KinectGestures.SwipeGesture=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(a,b){var c=a,d=(JointType.HandRight,c.checker),e=b,f={x:0,y:0,z:0},g=.01,h=5;this.Check=function(a){if(!(Math.abs(f.x-0)<g&&Math.abs(f.y-0)<g&&Math.abs(f.z-0)<g||!e&&d.GetRelativePosition(JointType.Head,JointType.HandLeft)[Direction.Upward]===!0)){var b=a.joints[JointType.HandRight].position.x-f.x,c=f.y-a.joints[JointType.HandRight].position.y,i=f.z-a.joints[JointType.HandRight].position.z;e&&((f.x<a.joints[JointType.ShoulderRight].position.x-.2&&b>0||f.x>a.joints[JointType.ShoulderRight].position.x+.4&&0>b)&&(f.x+=b/h),(f.y<a.joints[JointType.ShoulderRight].position.y-.3&&c>0||f.y>a.joints[JointType.ShoulderRight].position.y+.3&&0>c)&&(f.y+=c/h));var j="x:"+b.toFixed(3)+" y:"+c.toFixed(3)+" z:"+i.toFixed(3);return{res:1,args:j}}f=a.joints[JointType.HandRight].position}}function b(b){KinectGestures.GestureChecker.apply(this,arguments),this.gestureName=KinectGestures.GestureType.Joystick,this.person=b,this.timeout=5e3,this.conditions=[new a(b,!1)]}KinectGestures.Utils.Inherits(b,KinectGestures.GestureChecker),KinectGestures.JoystickGesture=b}(),window.KinectGestures=window.KinectGestures?window.KinectGestures:{},function(){function a(){function a(){h=window.innerWidth,i=window.innerHeight,j={x:h/2,y:i/2},m.width=h,m.height=i,m.style.width=h+"px",m.style.height=i+"px"}function b(b){if(!KinectGestures.DebugDrawer.CanvasElemntID)throw"You need to set a canvas element id to use Debug Drawer";if(!n){if(m=document.getElementById(KinectGestures.DebugDrawer.CanvasElemntID),!m)throw"Canvas Element ID not valid or not existing: "+KinectGestures.DebugDrawer.CanvasElemntID;if(n=m.getContext("2d"),!n)throw"Canvas Element is not a canvas: "+KinectGestures.DebugDrawer.CanvasElemntID;a(),window.addEventListener("resize",a)}n.clearRect(0,0,h,i);for(var d=0;d<b.skeletons.length;++d){var e=b.skeletons[d];if(e.trackingState>0){if(c(e,d),null!==KinectGestures.PlayerPosition.player1&&KinectGestures.PlayerRegister.initPositionPlayer1){var l=j.x+KinectGestures.PlayerRegister.initPositionPlayer1.x*k;g(l,i-20,40,"#000000","#000000"),g(l+80,i-20,40,"#000000","#000000"),g(l-80,i-20,40,"#000000","#000000"),f(l+80*KinectGestures.PlayerPosition.player1,i-20,40,"#ff0000")}else KinectGestures.PlayerRegister.initPositionPlayer1&&f(j.x+KinectGestures.PlayerRegister.initPositionPlayer1.x*k,i-20,40,"#ff0000");if(null!==KinectGestures.PlayerPosition.player2&&KinectGestures.PlayerRegister.initPositionPlayer2){var l=j.x+KinectGestures.PlayerRegister.initPositionPlayer2.x*k;g(l,i-20,40,"#000000","#000000"),g(l+80,i-20,40,"#000000","#000000"),g(l-80,i-20,40,"#000000","#000000"),f(l+80*KinectGestures.PlayerPosition.player2,i-20,40,"#ff0000")}else KinectGestures.PlayerRegister.initPositionPlayer2&&f(j.x+KinectGestures.PlayerRegister.initPositionPlayer2.x*k,i-20,40,"#ff0000");

}}}function c(a,b){var c=[],g=[],h=[],m=[],n=[];f(j.x+a.position.x*k,i-a.position.y*i,30,"#000000"),p=Math.max(p,a.position.y);for(var q=0;q<a.joints.length;++q){var r=a.joints[q];if(r.trackingState>1){var s={x:j.x+r.position.x*k,y:j.y-r.position.y*l};switch(f(s.x,s.y,10,o[b]),!0){case r.jointType<=3:c.push(s);break;case r.jointType>3&&r.jointType<=7:g.push(s);break;case r.jointType>7&&r.jointType<=11:h.push(s);break;case r.jointType>11&&r.jointType<=15:m.push(s);break;case r.jointType>15&&r.jointType<=19:n.push(s)}}}e(c),e(h),e(g),e(n),e(m),d(c[0],n[0]),d(c[0],m[0]),d(c[2],g[0]),d(c[2],h[0])}function d(a,b){a&&b&&(n.beginPath(),n.strokeStyle="#000000",n.moveTo(a.x,a.y),n.lineTo(b.x,b.y),n.stroke())}function e(a){if(a.length>0){n.beginPath(),n.strokeStyle="#000000",n.moveTo(a[0].x,a[0]);for(var b=0;b<a.length;b++)n.lineTo(a[b].x,a[b].y);n.stroke()}}function f(a,b,c,d){n.beginPath(),n.fillStyle=d?d:"#ff0000",n.arc(a,b,c?c:10,0,2*Math.PI),n.fill()}function g(a,b,c,d,e){n.beginPath(),n.fillStyle=d?d:"#ff0000",n.strokeStyle=e?e:"#ff0000",n.arc(a,b,c?c:10,0,2*Math.PI),n.fill(),n.stroke()}var h,i,j,k=300,l=300,m=null,n=null,o=["#ff0000","#ff00ff","#ffff00","#0000ff","#fff000","#000fff","#ff0000","#ff00ff"],p=0;return{update:b}}KinectGestures.DebugDrawer=a()}(window);